import{_ as a,c as i,o as n,ag as e}from"./chunks/framework.C7v41-tM.js";const c=JSON.parse('{"title":"â˜¸ï¸ Kubernetes å…¥é—¨","description":"","frontmatter":{},"headers":[],"relativePath":"devops/k8s.md","filePath":"devops/k8s.md","lastUpdated":1761307712000}'),t={name:"devops/k8s.md"};function l(p,s,h,r,d,k){return n(),i("div",null,[...s[0]||(s[0]=[e(`<h1 id="â˜¸ï¸-kubernetes-å…¥é—¨" tabindex="-1">â˜¸ï¸ Kubernetes å…¥é—¨ <a class="header-anchor" href="#â˜¸ï¸-kubernetes-å…¥é—¨" aria-label="Permalink to &quot;â˜¸ï¸ Kubernetes å…¥é—¨&quot;">â€‹</a></h1><h2 id="ç¯å¢ƒå‡†å¤‡-ğŸ³" tabindex="-1">ç¯å¢ƒå‡†å¤‡ ğŸ³ <a class="header-anchor" href="#ç¯å¢ƒå‡†å¤‡-ğŸ³" aria-label="Permalink to &quot;ç¯å¢ƒå‡†å¤‡ ğŸ³&quot;">â€‹</a></h2><ul><li>Docker Desktop</li></ul><h2 id="è®¾ç½®" tabindex="-1">è®¾ç½® <a class="header-anchor" href="#è®¾ç½®" aria-label="Permalink to &quot;è®¾ç½®&quot;">â€‹</a></h2><div class="info custom-block"><p class="custom-block-title">åœ¨docker Desktopè¿›è¡Œå¦‚ä¸‹è®¾ç½® ğŸ‰</p><p>setting -&gt; Kubernetes -&gt; Enable Kubernetes</p></div><p>ç­‰å¾…åŠ è½½å®Œæˆä½¿ç”¨ å‘½ä»¤ éªŒè¯</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --short</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="åˆ›å»ºdemo" tabindex="-1">åˆ›å»ºdemo <a class="header-anchor" href="#åˆ›å»ºdemo" aria-label="Permalink to &quot;åˆ›å»ºdemo&quot;">â€‹</a></h2><p>æœ¬åœ°åˆ›å»º ä¸€ä¸ªnginx çš„demo æ–°å»ºdeployment yaml</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deployment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html-deployment</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # æ ‡ç­¾å</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # å‰¯æœ¬æ•°</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  selector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    matchLabels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      containers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # container name</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nginx:latest</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # é•œåƒæ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          imagePullPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">IfNotPresent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">containerPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>è¿™ä¸ªåªæ˜¯å®šä¹‰äº†éƒ¨ç½²çš„ podçš„å®šä¹‰ è¿˜éœ€è¦å®šä¹‰å‘å¤–æš´éœ²çš„çš„æœåŠ¡ä¿¡æ¯ï¼ˆå¦‚æœä½¿ç”¨æœ¬åœ°çš„é•œåƒéœ€è¦è®¾ç½®k8sç¯å¢ƒå¯ä»¥è®¿é—®dockerï¼‰</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Service</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html-service</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  selector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">static-html</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # ğŸ‘ˆ åŒ¹é…ä¸Šé¢ Deployment çš„æ ‡ç­¾</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NodePort</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      targetPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      nodePort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30080</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # NodePort èŒƒå›´æ˜¯ 30000-32767</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æ‰§è¡Œè¿è¡Œpodå‘½ä»¤ <code>kubectl apply -f k8s-deployment.yaml</code>é€šè¿‡ <code>kubectl get pods</code> æŸ¥çœ‹pods æ‰§è¡Œè¿è¡Œservice <code>kubectl apply -f k8s-service.yaml</code> åŒæ ·å¯ä»¥é€šè¿‡ <code>kubectl get svc</code>æŸ¥çœ‹ è¿è¡ŒæˆåŠŸä¹‹åå¯ä»¥è®¿é—®<code>http://localhost:30080/</code> åˆ é™¤å‘½ä»¤</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s-deployment.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> k8s-service.yaml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="è®¿é—®dashboard" tabindex="-1">è®¿é—®dashboard <a class="header-anchor" href="#è®¿é—®dashboard" aria-label="Permalink to &quot;è®¿é—®dashboard&quot;">â€‹</a></h2><p>ä½¿ç”¨ <code>kubectl proxy</code> åè®¿é—®</p><blockquote><p><a href="http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/" target="_blank" rel="noreferrer">http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/</a></p></blockquote><p>ä¸€èˆ¬ä½¿ç”¨token ç™»å½• Dashboard é»˜è®¤éœ€è¦ ServiceAccount å’Œ ClusterRoleBinding æ‰èƒ½è®¿é—®é›†ç¾¤èµ„æºã€‚</p><ul><li>åˆ›å»º ServiceAccount</li></ul><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">apiVersion: v1</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">kind: ServiceAccount</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  name: admin-user</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  namespace: kubernetes-dashboard</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>åˆ›å»º ClusterRoleBinding</li></ul><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">apiVersion: rbac.authorization.k8s.io/v1</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">kind: ClusterRoleBinding</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  name: admin-user</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">roleRef:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  apiGroup: rbac.authorization.k8s.io</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  kind: ClusterRole</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  name: cluster-admin</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">subjects:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">- kind: ServiceAccount</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  name: admin-user</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  namespace: kubernetes-dashboard</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>è·å–ç™»å½•çš„token</li></ul><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes-dashboard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> token</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin-user</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ä½¿ç”¨ç”Ÿæˆçš„token å°±å¯ä»¥è®¿é—®äº†</p><h2 id="k8s-node-èŠ‚ç‚¹" tabindex="-1">K8s Nodeï¼ˆèŠ‚ç‚¹ï¼‰ <a class="header-anchor" href="#k8s-node-èŠ‚ç‚¹" aria-label="Permalink to &quot;K8s Nodeï¼ˆèŠ‚ç‚¹ï¼‰&quot;">â€‹</a></h2><ol><li>Node æ˜¯ Kubernetes é›†ç¾¤ä¸­ç”¨äºè¿è¡Œ <strong>Pod</strong> çš„å·¥ä½œèŠ‚ç‚¹ï¼ˆWorker Nodeï¼‰ã€‚</li><li>æ¯ä¸ª Node éƒ½åŒ…å«è¿è¡Œå®¹å™¨æ‰€éœ€çš„æ ¸å¿ƒç»„ä»¶ï¼š<code>kubelet</code>ã€<code>kube-proxy</code> å’Œå®¹å™¨è¿è¡Œæ—¶ï¼ˆcontainer runtimeï¼‰ã€‚</li></ol><p><strong>ä¸€ä¸ª K8s é›†ç¾¤é€šå¸¸åŒ…å«ï¼š</strong></p><ul><li>è‹¥å¹²ä¸ª <strong>Nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰</strong></li><li>æ¯ä¸ª Node å¯ä»¥è¿è¡Œå¤šä¸ª <strong>Pod</strong></li><li>æ§åˆ¶å¹³é¢ï¼ˆControl Planeï¼‰è´Ÿè´£è°ƒåº¦å“ªäº› Pod åº”è¯¥è¿è¡Œåœ¨å“ªä¸ª Node ä¸Šã€‚</li></ul><table tabindex="0"><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨è¯´æ˜</th></tr></thead><tbody><tr><td><strong>kubelet</strong></td><td>ç®¡ç†å½“å‰èŠ‚ç‚¹ä¸Šçš„ Pod ç”Ÿå‘½å‘¨æœŸï¼Œç›‘å¬æ¥è‡ªæ§åˆ¶å¹³é¢çš„æŒ‡ä»¤</td></tr><tr><td><strong>kube-proxy</strong></td><td>ç®¡ç†ç½‘ç»œè§„åˆ™ï¼Œå¤„ç† Pod é—´å’Œ Service çš„é€šä¿¡ä¸è´Ÿè½½å‡è¡¡</td></tr><tr><td><strong>å®¹å™¨è¿è¡Œæ—¶</strong>ï¼ˆå¦‚ containerdï¼‰</td><td>å®é™…æ‹‰å–é•œåƒå¹¶è¿è¡Œå®¹å™¨</td></tr></tbody></table><h3 id="pod" tabindex="-1">POD <a class="header-anchor" href="#pod" aria-label="Permalink to &quot;POD&quot;">â€‹</a></h3><p>åœ¨ Kubernetes ä¸­ï¼Œ<strong>Pod æ˜¯å®¹å™¨çš„æŠ½è±¡å±‚</strong>ã€‚ å®ƒä»£è¡¨é›†ç¾¤ä¸­è¿è¡Œçš„ä¸€ä¸ªåº”ç”¨å®ä¾‹ï¼Œé€šå¸¸åŒ…å«ï¼š</p><ul><li>ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼ˆContainerï¼‰</li><li>å­˜å‚¨å·ï¼ˆVolumeï¼‰</li><li>ç½‘ç»œå‘½åç©ºé—´ï¼ˆIPã€ç«¯å£ï¼‰</li><li>è¿è¡Œé…ç½®ï¼ˆç¯å¢ƒå˜é‡ã€æ¢é’ˆã€èµ„æºé™åˆ¶ç­‰ï¼‰</li></ul><h3 id="service" tabindex="-1">Service <a class="header-anchor" href="#service" aria-label="Permalink to &quot;Service&quot;">â€‹</a></h3><p>ä¸ºä»€ä¹ˆéœ€è¦ Serviceï¼Ÿ</p><ul><li>Pod æ˜¯çŸ­æš‚çš„ã€åŠ¨æ€çš„ï¼ŒIP åœ°å€ä¼šéš Pod é‡å¯è€Œå˜åŒ–</li><li>Service æä¾›ä¸€ä¸ª <strong>å›ºå®šçš„è®¿é—®å…¥å£</strong>ï¼Œå¹¶è‡ªåŠ¨è´Ÿè½½å‡è¡¡åˆ°å¯¹åº” Pod</li><li>Service å¯ç”¨äºï¼š <ul><li>é›†ç¾¤å†…éƒ¨é€šä¿¡ï¼ˆClusterIPï¼‰</li><li>å¯¹å¤–æš´éœ²ï¼ˆNodePortã€LoadBalancerï¼‰</li><li>HTTP è·¯ç”±ï¼ˆé…åˆ Ingressï¼‰</li></ul></li></ul><p>ç¤ºä¾‹ï¼šä¸º nginx Pod åˆ›å»º ClusterIP Service</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Service</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nginx-service</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  selector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nginx</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TCP</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # Service å¯¹å¤–ç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      targetPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Pod å®¹å™¨ç«¯å£</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ClusterIP</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="ingress" tabindex="-1">Ingress <a class="header-anchor" href="#ingress" aria-label="Permalink to &quot;Ingress&quot;">â€‹</a></h3><p><strong>route traffic into cluster = Ingress</strong></p><ul><li>æ˜¯ Kubernetes æä¾›çš„ä¸ƒå±‚ï¼ˆHTTP/HTTPSï¼‰è·¯ç”±è§„åˆ™å¯¹è±¡ï¼Œç”¨äºå°†å¤–éƒ¨è¯·æ±‚ï¼ˆé€šå¸¸æ¥è‡ªæµè§ˆå™¨ï¼‰è½¬å‘åˆ°é›†ç¾¤å†…éƒ¨çš„ Service å’Œ Pod</li><li>ä¸ºä»€ä¹ˆéœ€è¦ Ingressï¼Ÿ</li></ul><p>åœ¨ Kubernetes ä¸­ï¼ŒServiceï¼ˆå¦‚ ClusterIPï¼‰<strong>é»˜è®¤ä¸èƒ½è¢«å¤–éƒ¨è®¿é—®</strong>ï¼Œå³ä½¿ç”¨ NodePort/LoadBalancer æš´éœ²ä¹Ÿï¼š</p><ul><li>ä¸æ–¹ä¾¿ç®¡ç†å¤šä¸ªæœåŠ¡</li><li>ä¸æ”¯æŒåŸºäº URL æˆ–åŸŸååšè½¬å‘</li><li>ç¼ºå°‘ HTTPS æ”¯æŒ</li></ul><p>ğŸ‘‰ Ingress æä¾›ç»Ÿä¸€çš„å…¥å£ç½‘å…³ï¼Œçµæ´»è·¯ç”±ã€æ”¯æŒ TLSï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒä½¿ç”¨</p><p>ç¤ºä¾‹ï¼šå°†æµé‡æŒ‰è·¯å¾„è½¬å‘ç»™ä¸åŒæœåŠ¡</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># http://myapp.com/web â†’ è½¬å‘åˆ° web-service</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># http://myapp.com/api â†’ è½¬å‘åˆ° api-service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">networking.k8s.io/v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Ingress</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">example-ingress</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">myapp.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    http</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      paths</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/web</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        pathType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Prefix</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">web-service</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # å¯¹åº”service çš„åç§°</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/api</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        pathType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Prefix</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">api-service</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">              number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="dns-name" tabindex="-1">DNS Name <a class="header-anchor" href="#dns-name" aria-label="Permalink to &quot;DNS Name&quot;">â€‹</a></h3><ul><li>æ¯ä¸ª <strong>Service å’Œ Pod</strong> éƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å†Œåˆ°ä¸€ä¸ª<strong>å†…éƒ¨ DNS ç³»ç»Ÿä¸­</strong>ï¼Œä»è€Œå¯ä»¥é€šè¿‡â€œåå­—â€æ¥è®¿é—®æœåŠ¡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ IP åœ°å€</li><li>Kubernetes ä¸º Service è‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ DNS åç§°ï¼š</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\`service-name\`.\`namespace\`.svc.cluster.local</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="yaml-é…ç½®æ–‡ä»¶" tabindex="-1">Yaml é…ç½®æ–‡ä»¶ <a class="header-anchor" href="#yaml-é…ç½®æ–‡ä»¶" aria-label="Permalink to &quot;Yaml é…ç½®æ–‡ä»¶&quot;">â€‹</a></h2><h3 id="_1ï¸âƒ£-é€šç”¨-yaml-å­—æ®µè¯´æ˜" tabindex="-1">1ï¸âƒ£ é€šç”¨ YAML å­—æ®µè¯´æ˜ <a class="header-anchor" href="#_1ï¸âƒ£-é€šç”¨-yaml-å­—æ®µè¯´æ˜" aria-label="Permalink to &quot;1ï¸âƒ£ é€šç”¨ YAML å­—æ®µè¯´æ˜&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>apiVersion</td><td>string</td><td>API ç‰ˆæœ¬</td><td><code>v1</code>, <code>apps/v1</code></td></tr><tr><td>kind</td><td>string</td><td>èµ„æºç±»å‹</td><td><code>Pod</code>, <code>Deployment</code>, <code>Service</code></td></tr><tr><td>metadata</td><td>object</td><td>å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ nameã€namespaceã€labelsã€annotations</td><td><code>metadata:\\n name: nginx-pod\\n labels:\\n app: web</code></td></tr><tr><td>spec</td><td>object</td><td>èµ„æºè§„èŒƒï¼Œå®šä¹‰è¡Œä¸ºå’Œé…ç½®</td><td><code>spec:\\n replicas: 3\\n selector:\\n matchLabels:\\n app: web</code></td></tr><tr><td>status</td><td>object</td><td>çŠ¶æ€ä¿¡æ¯ï¼ˆç³»ç»Ÿç”Ÿæˆï¼Œåªè¯»ï¼‰</td><td><code>status:\\n phase: Running</code></td></tr></tbody></table><h3 id="_2ï¸âƒ£-pod-yaml-å­—æ®µ" tabindex="-1">2ï¸âƒ£ Pod YAML å­—æ®µ <a class="header-anchor" href="#_2ï¸âƒ£-pod-yaml-å­—æ®µ" aria-label="Permalink to &quot;2ï¸âƒ£ Pod YAML å­—æ®µ&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>containers</td><td>list</td><td>å®¹å™¨åˆ—è¡¨</td><td><code>containers:\\n - name: nginx\\n image: nginx:latest</code></td></tr><tr><td>initContainers</td><td>list</td><td>åˆå§‹åŒ–å®¹å™¨ï¼ŒPod å¯åŠ¨å‰æ‰§è¡Œ</td><td><code>initContainers:\\n - name: init-mydb\\n image: busybox</code></td></tr><tr><td>volumes</td><td>list</td><td>æŒ‚è½½å·</td><td><code>volumes:\\n - name: data\\n emptyDir: {}</code></td></tr><tr><td>restartPolicy</td><td>string</td><td>é‡å¯ç­–ç•¥</td><td><code>restartPolicy: Always</code></td></tr><tr><td>nodeSelector</td><td>object</td><td>èŠ‚ç‚¹é€‰æ‹©</td><td><code>nodeSelector:\\n role: frontend</code></td></tr><tr><td>tolerations</td><td>list</td><td>æ±¡ç‚¹å®¹å¿</td><td><code>tolerations:\\n - key: &quot;key&quot;\\n operator: &quot;Equal&quot;\\n value: &quot;value&quot;\\n effect: &quot;NoSchedule&quot;</code></td></tr><tr><td>affinity</td><td>object</td><td>Pod è°ƒåº¦äº²å’Œ/åäº²å’Œ</td><td><code>affinity:\\n podAntiAffinity: {...}</code></td></tr><tr><td>livenessProbe</td><td>object</td><td>å­˜æ´»æ¢é’ˆ</td><td><code>livenessProbe:\\n httpGet:\\n path: /\\n port: 80</code></td></tr><tr><td>readinessProbe</td><td>object</td><td>å°±ç»ªæ¢é’ˆ</td><td><code>readinessProbe:\\n tcpSocket:\\n port: 80</code></td></tr><tr><td>resources</td><td>object</td><td>CPU/å†…å­˜è¯·æ±‚ä¸é™åˆ¶</td><td><code>resources:\\n requests:\\n cpu: 250m\\n memory: 128Mi\\n limits:\\n cpu: 500m\\n memory: 256Mi</code></td></tr></tbody></table><h3 id="_3ï¸âƒ£-deployment-yaml-å­—æ®µ" tabindex="-1">3ï¸âƒ£ Deployment YAML å­—æ®µ <a class="header-anchor" href="#_3ï¸âƒ£-deployment-yaml-å­—æ®µ" aria-label="Permalink to &quot;3ï¸âƒ£ Deployment YAML å­—æ®µ&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>replicas</td><td>int</td><td>Pod å‰¯æœ¬æ•°</td><td><code>replicas: 3</code></td></tr><tr><td>selector</td><td>object</td><td>åŒ¹é… Pod æ ‡ç­¾</td><td><code>selector:\\n matchLabels:\\n app: web</code></td></tr><tr><td>template</td><td>object</td><td>Pod æ¨¡æ¿</td><td><code>template:\\n metadata:\\n labels:\\n app: web\\n spec:\\n containers: [...]</code></td></tr><tr><td>strategy</td><td>object</td><td>æ»šåŠ¨æ›´æ–°ç­–ç•¥</td><td><code>strategy:\\n type: RollingUpdate\\n rollingUpdate:\\n maxUnavailable: 1</code></td></tr></tbody></table><h3 id="_4ï¸âƒ£-service-yaml-å­—æ®µ" tabindex="-1">4ï¸âƒ£ Service YAML å­—æ®µ <a class="header-anchor" href="#_4ï¸âƒ£-service-yaml-å­—æ®µ" aria-label="Permalink to &quot;4ï¸âƒ£ Service YAML å­—æ®µ&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>selector</td><td>object</td><td>åŒ¹é… Pod æ ‡ç­¾</td><td><code>selector:\\n app: web</code></td></tr><tr><td>type</td><td>string</td><td>Service ç±»å‹</td><td><code>ClusterIP</code>, <code>NodePort</code>, <code>LoadBalancer</code>, <code>ExternalName</code></td></tr><tr><td>ports</td><td>list</td><td>ç«¯å£æ˜ å°„</td><td><code>ports:\\n - port: 80\\n targetPort: 80\\n nodePort: 30080</code></td></tr><tr><td>clusterIP</td><td>string</td><td>é›†ç¾¤å†…éƒ¨ IPï¼ˆå¯é€‰ï¼‰</td><td><code>clusterIP: None</code>ï¼ˆHeadless Serviceï¼‰</td></tr><tr><td>externalName</td><td>string</td><td>å¤–éƒ¨åŸŸå</td><td><code>externalName: example.com</code></td></tr><tr><td>sessionAffinity</td><td>string</td><td>ä¼šè¯ä¿æŒ</td><td><code>sessionAffinity: ClientIP</code></td></tr></tbody></table><h3 id="_5ï¸âƒ£-ingress-yaml-å­—æ®µ" tabindex="-1">5ï¸âƒ£ Ingress YAML å­—æ®µ <a class="header-anchor" href="#_5ï¸âƒ£-ingress-yaml-å­—æ®µ" aria-label="Permalink to &quot;5ï¸âƒ£ Ingress YAML å­—æ®µ&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>rules</td><td>list</td><td>è·¯ç”±è§„åˆ™</td><td><code>rules:\\n - host: myapp.local\\n http:\\n paths:\\n - path: /\\n pathType: Prefix\\n backend:\\n service:\\n name: nginx-service\\n port:\\n number: 80</code></td></tr><tr><td>tls</td><td>list</td><td>TLS é…ç½®</td><td><code>tls:\\n - hosts:\\n - myapp.local\\n secretName: my-tls-secret</code></td></tr><tr><td>annotations</td><td>object</td><td>æ§åˆ¶å™¨ç‰¹å®šé…ç½®</td><td><code>annotations:\\n kubernetes.io/ingress.class: nginx</code></td></tr></tbody></table><h3 id="_6ï¸âƒ£-é«˜çº§-yaml-ç‰¹æ€§" tabindex="-1">6ï¸âƒ£ é«˜çº§ YAML ç‰¹æ€§ <a class="header-anchor" href="#_6ï¸âƒ£-é«˜çº§-yaml-ç‰¹æ€§" aria-label="Permalink to &quot;6ï¸âƒ£ é«˜çº§ YAML ç‰¹æ€§&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>é”šç‚¹ &amp; åˆ«å</td><td>é¿å…é‡å¤é…ç½®</td><td><code>defaults: &amp;defaults\\n image: nginx:latest\\npod1:\\n &lt;&lt;: *defaults</code></td></tr><tr><td>å¤šæ–‡æ¡£æ–‡ä»¶</td><td>ç”¨ <code>---</code> åˆ†éš”å¤šä¸ªæ–‡æ¡£</td><td><code>---\\napiVersion: v1\\nkind: Pod\\n...\\n---\\napiVersion: v1\\nkind: Pod\\n...</code></td></tr><tr><td>å¤šè¡Œå­—ç¬¦ä¸²</td><td>\`</td><td><code> ä¿ç•™æ¢è¡Œï¼Œ</code>&gt;\` æŠ˜å æ¢è¡Œ</td></tr></tbody></table><h3 id="_7ï¸âƒ£-å¸¸è§-yaml-é”™è¯¯" tabindex="-1">7ï¸âƒ£ å¸¸è§ YAML é”™è¯¯ <a class="header-anchor" href="#_7ï¸âƒ£-å¸¸è§-yaml-é”™è¯¯" aria-label="Permalink to &quot;7ï¸âƒ£ å¸¸è§ YAML é”™è¯¯&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>é”™è¯¯</th><th>åŸå› </th><th>è§£å†³æ–¹æ³•</th></tr></thead><tbody><tr><td><code>expected &lt;block end&gt;</code></td><td>ç¼©è¿›é”™è¯¯æˆ–ç©ºæ ¼ä¸ä¸€è‡´</td><td>ä½¿ç”¨ç©ºæ ¼ç¼©è¿›ï¼Œé¿å… Tab</td></tr><tr><td><code>mapping values are not allowed</code></td><td>é”®å€¼ç¼ºå°‘å†’å·</td><td>æ£€æŸ¥å†’å·å’Œç©ºæ ¼</td></tr><tr><td><code>unknown field</code></td><td>å­—æ®µæ‹¼å†™é”™è¯¯</td><td>å¯¹ç…§å®˜æ–¹ API æ–‡æ¡£</td></tr><tr><td>CrashLoopBackOff</td><td>å®¹å™¨æˆ–é…ç½®é”™è¯¯</td><td>æ£€æŸ¥å®¹å™¨é•œåƒã€ç«¯å£ã€æ¢é’ˆè®¾ç½®</td></tr></tbody></table><h3 id="_8ï¸âƒ£-å°ç»“" tabindex="-1">8ï¸âƒ£ å°ç»“ <a class="header-anchor" href="#_8ï¸âƒ£-å°ç»“" aria-label="Permalink to &quot;8ï¸âƒ£ å°ç»“&quot;">â€‹</a></h3><ul><li>Kubernetes YAML æ ¸å¿ƒå­—æ®µï¼š<code>apiVersion</code>ã€<code>kind</code>ã€<code>metadata</code>ã€<code>spec</code></li><li>Pod æ˜¯æœ€å°è°ƒåº¦å•å…ƒï¼ŒDeployment ç®¡ç† Pod å‰¯æœ¬</li><li>Service æä¾›ç¨³å®šè®¿é—®ï¼ŒIngress ç®¡ç†å¤–éƒ¨è·¯ç”±</li><li>æŒæ¡ç¼©è¿›ã€åˆ—è¡¨ã€å­—å…¸ã€æ³¨é‡Šã€å¤šæ–‡æ¡£ç­‰ YAML ç‰¹æ€§</li><li>é«˜çº§ç‰¹æ€§ï¼šé”šç‚¹ã€åˆ«åã€å¤šè¡Œå­—ç¬¦ä¸²ï¼Œé¿å…é‡å¤å’Œå†—é•¿</li></ul><h3 id="ğŸ“š-å‚è€ƒèµ„æ–™" tabindex="-1">ğŸ“š å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#ğŸ“š-å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;ğŸ“š å‚è€ƒèµ„æ–™&quot;">â€‹</a></h3><ul><li>Kubernetes å®˜æ–¹æ–‡æ¡£ YAMLï¼š<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/" target="_blank" rel="noreferrer">https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/</a></li><li>YAML å®˜æ–¹è§„èŒƒï¼š<a href="https://yaml.org/spec/" target="_blank" rel="noreferrer">https://yaml.org/spec/</a></li><li>Kubernetes Cheat Sheetï¼š<a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/" target="_blank" rel="noreferrer">https://kubernetes.io/docs/reference/kubectl/cheatsheet/</a></li></ul><h2 id="demo" tabindex="-1">Demo <a class="header-anchor" href="#demo" aria-label="Permalink to &quot;Demo&quot;">â€‹</a></h2><p><a href="https://github.com/wwELi/nuxt-app/blob/main/deployment/deployment.yml" target="_blank" rel="noreferrer">https://github.com/wwELi/nuxt-app/blob/main/deployment/deployment.yml</a></p>`,70)])])}const b=a(t,[["render",l]]);export{c as __pageData,b as default};
