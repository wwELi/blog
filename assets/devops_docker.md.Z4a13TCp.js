import{_ as a,c as i,o as t,ag as n}from"./chunks/framework.C7v41-tM.js";const c=JSON.parse('{"title":"ğŸ³ Docker å­¦ä¹ æ–‡æ¡£","description":"","frontmatter":{},"headers":[],"relativePath":"devops/docker.md","filePath":"devops/docker.md","lastUpdated":1761553378000}'),e={name:"devops/docker.md"};function l(r,s,d,p,h,o){return t(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="ğŸ³-docker-å­¦ä¹ æ–‡æ¡£" tabindex="-1">ğŸ³ Docker å­¦ä¹ æ–‡æ¡£ <a class="header-anchor" href="#ğŸ³-docker-å­¦ä¹ æ–‡æ¡£" aria-label="Permalink to &quot;ğŸ³ Docker å­¦ä¹ æ–‡æ¡£&quot;">â€‹</a></h1><blockquote><p>ä¸€ä»½ä»é›¶å¼€å§‹çš„ Docker å…¥é—¨æŒ‡å—ï¼ŒåŒ…å«å®‰è£…ã€æ ¸å¿ƒæ¦‚å¿µã€è¿è¡Œå®¹å™¨åŠå¸¸ç”¨å‘½ä»¤ã€‚</p></blockquote><h2 id="_1-ä»€ä¹ˆæ˜¯-docker" tabindex="-1">1. ä»€ä¹ˆæ˜¯ Docker <a class="header-anchor" href="#_1-ä»€ä¹ˆæ˜¯-docker" aria-label="Permalink to &quot;1. ä»€ä¹ˆæ˜¯ Docker&quot;">â€‹</a></h2><p>Docker æ˜¯ä¸€ä¸ª <strong>å®¹å™¨åŒ–å¹³å°</strong>ï¼Œç”¨äºå°†åº”ç”¨åŠå…¶ä¾èµ–æ‰“åŒ…æˆè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ã€‚ å®¹å™¨å¯ä»¥åœ¨ä»»ä½•å®‰è£…äº† Docker çš„ä¸»æœºä¸Šè¿è¡Œï¼Œå®ç° â€œä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚</p><h3 id="âœ¨-ä¼˜ç‚¹" tabindex="-1">âœ¨ ä¼˜ç‚¹ <a class="header-anchor" href="#âœ¨-ä¼˜ç‚¹" aria-label="Permalink to &quot;âœ¨ ä¼˜ç‚¹&quot;">â€‹</a></h3><ul><li>å¯åŠ¨é€Ÿåº¦å¿«ï¼Œèµ„æºå ç”¨ä½</li><li>ç¯å¢ƒä¸€è‡´ï¼Œé¿å…â€œåœ¨æˆ‘æœºå™¨ä¸Šæ²¡é—®é¢˜â€</li><li>æ˜“äºéƒ¨ç½²ã€æ‰©å±•å’Œè¿ç§»</li><li>æ”¯æŒå¾®æœåŠ¡æ¶æ„</li></ul><h2 id="_2-å®‰è£…-docker" tabindex="-1">2. å®‰è£… Docker <a class="header-anchor" href="#_2-å®‰è£…-docker" aria-label="Permalink to &quot;2. å®‰è£… Docker&quot;">â€‹</a></h2><h3 id="ğŸ-macos" tabindex="-1">ğŸ macOS <a class="header-anchor" href="#ğŸ-macos" aria-label="Permalink to &quot;ğŸ macOS&quot;">â€‹</a></h3><ol><li>ä¸‹è½½ <a href="https://www.docker.com/products/docker-desktop/" target="_blank" rel="noreferrer">https://www.docker.com/products/docker-desktop/</a></li><li>æ‹–æ‹½å®‰è£…åˆ°â€œåº”ç”¨ç¨‹åºâ€æ–‡ä»¶å¤¹</li><li>å¯åŠ¨ Docker å¹¶éªŒè¯ï¼š docker --version</li></ol><h3 id="ğŸ§-linux-ubuntu-ç¤ºä¾‹" tabindex="-1">ğŸ§ Linuxï¼ˆUbuntu ç¤ºä¾‹ï¼‰ <a class="header-anchor" href="#ğŸ§-linux-ubuntu-ç¤ºä¾‹" aria-label="Permalink to &quot;ğŸ§ Linuxï¼ˆUbuntu ç¤ºä¾‹ï¼‰&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ca-certificates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gnupg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lsb-release</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apt/keyrings</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fsSL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://download.docker.com/linux/ubuntu/gpg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gpg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dearmor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apt/keyrings/docker.gpg</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;deb [arch=$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --print-architecture</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsb_release</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -cs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) stable&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apt/sources.list.d/docker.list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-ce</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-ce-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> containerd.io</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose-plugin</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="ä½¿ç”¨-colima" tabindex="-1">ä½¿ç”¨ colima <a class="header-anchor" href="#ä½¿ç”¨-colima" aria-label="Permalink to &quot;ä½¿ç”¨ colima&quot;">â€‹</a></h3><p>Use colima run docker compose <a href="https://smallsharpsoftwaretools.com/tutorials/use-colima-to-run-docker-containers-on-macos/" target="_blank" rel="noreferrer">https://smallsharpsoftwaretools.com/tutorials/use-colima-to-run-docker-containers-on-macos/</a></p><h2 id="_3-docker-åŸºæœ¬æ¦‚å¿µ" tabindex="-1">3. Docker åŸºæœ¬æ¦‚å¿µ <a class="header-anchor" href="#_3-docker-åŸºæœ¬æ¦‚å¿µ" aria-label="Permalink to &quot;3. Docker åŸºæœ¬æ¦‚å¿µ&quot;">â€‹</a></h2><ul><li>é•œåƒ (Image)ï¼šå®¹å™¨çš„æ¨¡æ¿ã€‚</li><li>å®¹å™¨ (Container)ï¼šé•œåƒè¿è¡Œåçš„å®ä¾‹ã€‚</li><li>ä»“åº“ (Repository)ï¼šå­˜æ”¾é•œåƒçš„åœ°æ–¹ï¼Œå¦‚ Docker Hubã€‚</li><li>Dockerfileï¼šå®šä¹‰å¦‚ä½•æ„å»ºé•œåƒçš„æ–‡ä»¶ã€‚</li></ul><table tabindex="0"><thead><tr><th></th><th><strong>Docker Image</strong></th><th><strong>Docker Container</strong></th></tr></thead><tbody><tr><td><strong>ç±»å‹</strong></td><td>The actual package (é™æ€æ–‡ä»¶)</td><td>Actually start the application (åŠ¨æ€è¿è¡Œå®ä¾‹)</td></tr><tr><td><strong>æ¯”å–»ç†è§£</strong></td><td>Image å°±åƒæ˜¯ç±»ï¼ˆClassï¼‰</td><td>Container å°±åƒæ˜¯ç±»çš„å®ä¾‹ï¼ˆObjectï¼‰</td></tr><tr><td><strong>å…³ç³»</strong></td><td>æ¯ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨å®ä¾‹</td><td>æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç‹¬ç«‹è¿è¡Œçš„å®ä¾‹</td></tr></tbody></table><p><strong>Docker vs. Virtual Machine</strong></p><ul><li>Docker -&gt; è™šæ‹ŸåŒ– -&gt; (OS) Applications</li><li>Virtual Machine -&gt; è™šæ‹ŸåŒ– -&gt; (OS) Applications &amp; Kernel</li></ul><table tabindex="0"><thead><tr><th></th><th><strong>Docker</strong></th><th><strong>Virtual Machine</strong></th></tr></thead><tbody><tr><td><strong>å¯åŠ¨é€Ÿåº¦</strong></td><td>ç§’çº§</td><td>åˆ†é’Ÿçº§</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>è¾ƒä½ï¼ˆå…±äº«ä¸»æœºå†…æ ¸ï¼‰</td><td>è¾ƒé«˜ï¼ˆè¿è¡Œå®Œæ•´æ“ä½œç³»ç»Ÿï¼‰</td></tr><tr><td><strong>æ‰€éœ€èµ„æº</strong></td><td>æ›´å°‘ï¼ˆè½»é‡ï¼‰</td><td>æ›´å¤šï¼ˆéœ€è¦æ•´ä¸ª OSï¼‰</td></tr><tr><td><strong>æ–‡ä»¶ä½“ç§¯</strong></td><td>å°ï¼ˆMB ~ å‡ ç™¾ MBï¼‰</td><td>å¤§ï¼ˆGBï¼‰</td></tr></tbody></table><h2 id="_4-è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªå®¹å™¨" tabindex="-1">4. è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªå®¹å™¨ <a class="header-anchor" href="#_4-è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªå®¹å™¨" aria-label="Permalink to &quot;4. è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªå®¹å™¨&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hello-world</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>è¾“å‡ºï¼š Hello from Docker! This message shows that your installation appears to be working correctly.</p><h2 id="_5-å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥" tabindex="-1">5. å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ <a class="header-anchor" href="#_5-å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥" aria-label="Permalink to &quot;5. å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥&quot;">â€‹</a></h2><h3 id="docker" tabindex="-1">Docker <a class="header-anchor" href="#docker" aria-label="Permalink to &quot;Docker&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th><strong>ç±»åˆ«</strong></th><th><strong>å‘½ä»¤</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td><strong>é•œåƒç®¡ç†(Image)</strong></td><td><strong>docker pull <code>é•œåƒå</code></strong></td><td>ä»ä»“åº“æ‹‰å–é•œåƒ<br>é»˜è®¤å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ï¼šlibrary</td></tr><tr><td><strong>é•œåƒç®¡ç†(Image)</strong></td><td><strong>docker pull <code>registry</code>/<code>namespace</code>/<code>image</code>:<code>tag</code></strong></td><td>å½“ä½ ä½¿ç”¨ <strong>ç§æœ‰ä»“åº“ï¼ˆPrivate Registryï¼‰</strong> æˆ– <strong>ç»„ç»‡é•œåƒï¼ˆOrganization Repositoryï¼‰</strong> æ—¶ï¼Œæ‹‰å–é•œåƒéœ€è¦ï¼šä½¿ç”¨å®Œæ•´é•œåƒè·¯å¾„<br><br>ç§æœ‰ä»“åº“éœ€è¦ç™»å½•è®¤è¯ï¼š<br>docker login <code>registry</code><br>ç³»ç»Ÿä¼šæç¤ºä½ è¾“å…¥ï¼šç”¨æˆ·å &amp; å¯†ç <br>ç™»å½•æˆåŠŸåï¼Œå‡­æ®ä¼šä¿å­˜åœ¨æœ¬åœ°çš„ <code>~/.docker/config.json</code>ï¼Œæ‹‰å–é•œåƒæ—¶è‡ªåŠ¨ä½¿ç”¨</td></tr><tr><td><strong>é•œåƒç®¡ç†(Image)</strong></td><td><strong>docker images</strong></td><td>æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker run -d -p <code>å®¿ä¸»æœºç«¯å£</code>:<code>å®¹å™¨ç«¯å£</code> --name <code>å®¹å™¨åç§°</code> <code>é•œåƒåç§°</code></strong></td><td>ä»æŒ‡å®šé•œåƒåˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨<br>â€¢ -d : åå°è¿è¡Œ (detach)<br>â€¢ -p <code>å®¿ä¸»æœºç«¯å£</code>:<code>å®¹å™¨ç«¯å£</code> ï¼šç«¯å£æ˜ å°„</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker ps</strong></td><td>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker ps -a</strong></td><td>æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢ï¼‰</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker stop <code>å®¹å™¨ID</code></strong></td><td>åœæ­¢å®¹å™¨</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker start <code>å®¹å™¨ID</code></strong></td><td>å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker restart <code>å®¹å™¨ID</code></strong></td><td>é‡å¯å®¹å™¨</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker rm <code>å®¹å™¨ID</code></strong></td><td>åˆ é™¤å®¹å™¨</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker logs <code>å®¹å™¨ID</code></strong></td><td>æŸ¥çœ‹å®¹å™¨æ—¥å¿—</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker exec -it <code>å®¹å™¨ID</code> /bin/bash</strong></td><td>ä»¥æ™®é€šç”¨æˆ·èº«ä»½è¿›å…¥å®¹å™¨äº¤äº’ç»ˆç«¯</td></tr><tr><td><strong>å®¹å™¨ç®¡ç† (Container)</strong></td><td><strong>docker exec -u -0 -it <code>å®¹å™¨ID</code> /bin/bash</strong></td><td>ä»¥root userèº«ä»½è¿›å…¥å®¹å™¨äº¤äº’ç»ˆç«¯</td></tr></tbody></table><h3 id="docker-compose" tabindex="-1">Docker Compose <a class="header-anchor" href="#docker-compose" aria-label="Permalink to &quot;Docker Compose&quot;">â€‹</a></h3><ul><li>Docker Compose æ˜¯ Docker å®˜æ–¹æä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨æ¥å®šä¹‰å’Œç®¡ç†å¤šå®¹å™¨åº”ç”¨</li><li>Docker Compose è®©ä½ ç”¨ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸€æ¡å‘½ä»¤ï¼Œå¯åŠ¨æ•´ä¸ªé¡¹ç›®çš„å¤šä¸ªæœåŠ¡ï¼ˆå®¹å™¨ï¼‰ â€” æ¯”å¦‚å‰ç«¯ + åç«¯ + æ•°æ®åº“</li><li>æ ¸å¿ƒæ–‡ä»¶ï¼šdocker-compose.yml <ul><li>è¿™æ˜¯ä¸€ä¸ª YAML æ–‡ä»¶ï¼Œç”¨æ¥å£°æ˜ï¼š</li><li>è¦å¯åŠ¨å“ªäº›æœåŠ¡ï¼ˆå¦‚ appã€dbï¼‰</li><li>ä½¿ç”¨ä»€ä¹ˆé•œåƒã€Dockerfile</li><li>ç«¯å£æ˜ å°„ã€ç¯å¢ƒå˜é‡ã€ç½‘ç»œã€å·æŒ‚è½½ç­‰é…ç½®</li></ul></li><li>å¸¸ç”¨å‘½ä»¤</li></ul><table tabindex="0"><thead><tr><th><strong>æ“ä½œ</strong></th><th><strong>å‘½ä»¤/æè¿°</strong></th></tr></thead><tbody><tr><td>å¯åŠ¨æœåŠ¡</td><td>docker compose up</td></tr><tr><td>åå°è¿è¡Œ</td><td>docker compose up -d</td></tr><tr><td>åœæ­¢æœåŠ¡</td><td>docker compose down</td></tr><tr><td>ä¸€å¹¶æ¸…é™¤ volumes</td><td>docker-compose down -v</td></tr><tr><td>æŸ¥çœ‹çŠ¶æ€</td><td>docker compose ps</td></tr><tr><td>æŸ¥çœ‹æ—¥å¿—</td><td>docker compose logs</td></tr><tr><td>å®šä¹‰æ–‡ä»¶</td><td>docker-compose.yml</td></tr></tbody></table><h2 id="_6-ç¤ºä¾‹-è¿è¡Œ-nginx-web-æœåŠ¡å™¨" tabindex="-1">6. ç¤ºä¾‹ï¼šè¿è¡Œ Nginx Web æœåŠ¡å™¨ <a class="header-anchor" href="#_6-ç¤ºä¾‹-è¿è¡Œ-nginx-web-æœåŠ¡å™¨" aria-label="Permalink to &quot;6. ç¤ºä¾‹ï¼šè¿è¡Œ Nginx Web æœåŠ¡å™¨&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mynginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8080:80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  nginx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>è®¿é—®ï¼š <a href="http://localhost:8080" target="_blank" rel="noreferrer">http://localhost:8080</a></p><h2 id="_7-dockerfile-ç¤ºä¾‹" tabindex="-1">7. Dockerfile ç¤ºä¾‹ <a class="header-anchor" href="#_7-dockerfile-ç¤ºä¾‹" aria-label="Permalink to &quot;7. Dockerfile ç¤ºä¾‹&quot;">â€‹</a></h2><p><strong>Dockerfile æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨æ¥å®šä¹‰â€œå¦‚ä½•æ„å»ºä¸€ä¸ª Docker é•œåƒâ€</strong></p><table tabindex="0"><thead><tr><th>æŒ‡ä»¤</th><th>ä½œç”¨è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>FROM</td><td>æŒ‡å®šåŸºç¡€é•œåƒï¼Œæ‰€æœ‰é•œåƒéƒ½ä»æŸä¸ªé•œåƒå¼€å§‹æ„å»º</td><td>FROM node:18</td></tr><tr><td>WORKDIR</td><td>è®¾ç½®å·¥ä½œç›®å½•ï¼Œåç»­å‘½ä»¤éƒ½åœ¨æ­¤ç›®å½•æ‰§è¡Œç›¸å½“äºæ‰§è¡ŒCD å‘½ä»¤</td><td>WORKDIR /app</td></tr><tr><td>COPY</td><td>å°†æœ¬åœ°æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°é•œåƒä¸­</td><td>COPY package.json ./</td></tr><tr><td>ADD</td><td>å¤åˆ¶æ–‡ä»¶ï¼Œæ”¯æŒè‡ªåŠ¨è§£å‹ tar æ–‡ä»¶ï¼Œè¿˜æ”¯æŒ URL ä¸‹è½½</td><td>ADD app.tar.gz /app/</td></tr><tr><td>RUN</td><td>åœ¨é•œåƒæ„å»ºæ—¶æ‰§è¡Œå‘½ä»¤ï¼ˆå¦‚å®‰è£…ä¾èµ–ï¼‰</td><td>RUN npm install</td></tr><tr><td>CMD</td><td>å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„é»˜è®¤å‘½ä»¤ï¼ˆå¯ä»¥è¢«è¦†ç›–ï¼‰</td><td>CMD [&quot;node&quot;, &quot;index.js&quot;]</td></tr><tr><td>ENTRYPOINT</td><td>å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ï¼Œé€šå¸¸æ­é… CMD ä½¿ç”¨ï¼Œè¾ƒéš¾è¦†ç›–</td><td>ENTRYPOINT [&quot;python&quot;]</td></tr><tr><td>ENV</td><td>è®¾ç½®ç¯å¢ƒå˜é‡</td><td>ENV NODE_ENV production</td></tr><tr><td>EXPOSE</td><td>å£°æ˜å®¹å™¨ç›‘å¬çš„ç«¯å£ï¼ˆä»…åšè¯´æ˜ï¼Œç«¯å£æ˜ å°„éœ€ç”¨ docker runï¼‰</td><td>EXPOSE 3000</td></tr><tr><td>VOLUME</td><td>å£°æ˜æ•°æ®å·ï¼Œæ•°æ®æŒä¹…åŒ–æˆ–å…±äº«</td><td>VOLUME /data/db</td></tr><tr><td>USER</td><td>æŒ‡å®šè¿è¡Œå‘½ä»¤çš„ç”¨æˆ·åæˆ– UID</td><td>USER node</td></tr><tr><td>ARG</td><td>å®šä¹‰æ„å»ºæ—¶å˜é‡ï¼ˆä»…åœ¨ build é˜¶æ®µæœ‰æ•ˆï¼‰</td><td>ARG APP_VERSION=1.0</td></tr><tr><td>ONBUILD</td><td>ä¸ºåç»­åŸºäºæ­¤é•œåƒçš„ Dockerfile è®¾ç½®è§¦å‘æ„å»ºæŒ‡ä»¤</td><td>ONBUILD COPY . /app</td></tr><tr><td>LABEL</td><td>æ·»åŠ å…ƒæ•°æ®æ ‡ç­¾ï¼Œæ–¹ä¾¿ç®¡ç†å’ŒæŸ¥è¯¢</td><td>LABEL <a href="mailto:maintainer=%22me@example.com" target="_blank" rel="noreferrer">maintainer=&quot;me@example.com</a>&quot;</td></tr></tbody></table><p><strong>ç¤ºä¾‹æ„å»ºnodeåº”ç”¨çš„é•œåƒ</strong></p><div class="language-docker vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">docker</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node:18</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /app</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> package*.json ./</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npm install</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> . .</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3000</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CMD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;npm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æ„å»ºé•œåƒï¼š</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mynodeapp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>è¿è¡Œå®¹å™¨ï¼š</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3000:3000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mynodeapp</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="_8-docker-volumes" tabindex="-1">8. Docker Volumes <a class="header-anchor" href="#_8-docker-volumes" aria-label="Permalink to &quot;8. Docker Volumes&quot;">â€‹</a></h2><p><strong>é…ç½®Volumes çš„ä½œç”¨</strong></p><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼šå®¹å™¨ä¸­çš„æ•°æ®æ˜¯ä¸´æ—¶çš„ ä¸€æ—¦å®¹å™¨åˆ é™¤ï¼Œæ•°æ®ä¹Ÿå°±æ²¡äº†,ä¸ºäº†ä¿å­˜æ•°æ®ï¼ˆæ¯”å¦‚æ•°æ®åº“æ–‡ä»¶ã€æ—¥å¿—ã€ä¸Šä¼ çš„ç”¨æˆ·æ–‡ä»¶ç­‰ï¼‰ï¼Œå°±éœ€è¦ä½¿ç”¨ Volume</li><li>Docker Volumes æ˜¯ Docker æä¾›çš„ä¸€ç§æŒä¹…åŒ–æ•°æ®çš„æœºåˆ¶ï¼Œå…è®¸å®¹å™¨ä¸­çš„æ•°æ®ä¿å­˜åˆ°å®¿ä¸»æœºä¸Šï¼Œå³ä½¿å®¹å™¨è¢«åˆ é™¤ï¼Œæ•°æ®ä»ç„¶ä¿ç•™</li><li>ä½ å¯ä»¥ç®€å•ç†è§£ä¸ºï¼šVolume = æŒ‚åœ¨å®¹å™¨ä¸Šçš„ä¸€ä¸ªå®¿ä¸»æœºä¸Šçš„æ–‡ä»¶å¤¹</li></ul><ol><li><strong>æŒ‚è½½æœ¬åœ°ç›®å½•</strong><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å°† æœ¬åœ°ç›®å½• ./data æ˜ å°„åˆ°å®¹å™¨å†…çš„ /app/data</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¸¸ç”¨äºå¼€å‘ç¯å¢ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">my-app</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./data:/app/data</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li><strong>ä½¿ç”¨å‘½åå·</strong><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®¹å™¨å†…è·¯å¾„ /var/lib/postgresql/data ä½¿ç”¨ä¸€ä¸ªåä¸º db-data çš„ volume æŒä¹…åŒ–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Docker è‡ªåŠ¨ç®¡ç†è¿™ä¸ª volume çš„è·¯å¾„ä¸ç”Ÿå‘½å‘¨æœŸ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼ˆæ¯” bind mount æ›´éš”ç¦»ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">postgres</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">db-data:/var/lib/postgresql/data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      db-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li><li><strong>æŸ¥çœ‹å’Œç®¡ç†</strong><table tabindex="0"><thead><tr><th><strong>å‘½ä»¤</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>docker volume ls</strong></td><td>æŸ¥çœ‹æ‰€æœ‰å·</td></tr><tr><td><strong>docker volume inspect my-volume</strong></td><td>æŸ¥çœ‹å·ç»†èŠ‚</td></tr><tr><td><strong>docker volume rm my-volume</strong></td><td>åˆ é™¤å·ï¼ˆéœ€ç¡®ä¿æ²¡æœ‰å®¹å™¨åœ¨ä½¿ç”¨ï¼‰</td></tr></tbody></table></li></ol><h2 id="_9-å¤šé˜¶æ®µæ„å»º" tabindex="-1">9. å¤šé˜¶æ®µæ„å»º <a class="header-anchor" href="#_9-å¤šé˜¶æ®µæ„å»º" aria-label="Permalink to &quot;9. å¤šé˜¶æ®µæ„å»º&quot;">â€‹</a></h2><ul><li>å¤šé˜¶æ®µæ„å»ºå°±æ˜¯åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨å¤šä¸ªé•œåƒé˜¶æ®µï¼Œåœ¨å‰é¢çš„é˜¶æ®µä¸­æ„å»ºä»£ç ã€ç¼–è¯‘äº§ç‰©ï¼Œæœ€ååªå°†éœ€è¦çš„å†…å®¹å¤åˆ¶è¿›æœ€ç»ˆçš„è¿è¡Œé•œåƒ</li><li>å®ƒå…è®¸ä½ åœ¨ä¸€ä¸ª Dockerfile ä¸­å®šä¹‰å¤šä¸ª <code>FROM</code> é˜¶æ®µï¼Œå¹¶ä»å‰ä¸€ä¸ªé˜¶æ®µä¸­é€‰æ‹©æ€§åœ°å¤åˆ¶æ–‡ä»¶åˆ°æœ€ç»ˆé•œåƒä¸­</li><li>åªæœ‰æœ€åä¸€ä¸ªé˜¶æ®µçš„å†…å®¹æ‰ä¼šä¿ç•™âœ…æ‰€æœ‰é˜¶æ®µéƒ½ä¼šè¿›å…¥æœ€ç»ˆé•œåƒâŒ</li></ul><p><strong>demo ä½¿ç”¨node æ‰“åŒ…å‰ç«¯é¡¹ç›®åç”¨nginxæ‰˜ç®¡</strong></p><div class="language-docker vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">docker</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node:latest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node-01</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ./html /html/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ./app /app/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /app</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npm install</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> npm run build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --from=node-01 /dist /usr/share/nginx/html</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ./html/assets /usr/share/nginx/html/assets</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> default.conf /etc/nginx/conf.d/default.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_10-å‚è€ƒèµ„æ–™" tabindex="-1">10. å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#_10-å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;10. å‚è€ƒèµ„æ–™&quot;">â€‹</a></h2><ul><li>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com" target="_blank" rel="noreferrer">https://docs.docker.com</a></li><li>Docker Hubï¼š<a href="https://hub.docker.com" target="_blank" rel="noreferrer">https://hub.docker.com</a></li><li>åœ¨çº¿å®éªŒç¯å¢ƒï¼š<a href="https://labs.play-with-docker.com" target="_blank" rel="noreferrer">https://labs.play-with-docker.com</a></li></ul>`,50)])])}const g=a(e,[["render",l]]);export{c as __pageData,g as default};
